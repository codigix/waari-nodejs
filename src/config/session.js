// session.config.js
require('dotenv').config();
const slugify = require('slugify');

module.exports = {
  /*
  |--------------------------------------------------------------------------
  | Default Session Driver
  |--------------------------------------------------------------------------
  */
  driver: process.env.SESSION_DRIVER || 'file', // file, cookie, database, redis, etc.

  /*
  |--------------------------------------------------------------------------
  | Session Lifetime
  |--------------------------------------------------------------------------
  */
  lifetime: parseInt(process.env.SESSION_LIFETIME || '600', 10), // in minutes
  expireOnClose: false,

  /*
  |--------------------------------------------------------------------------
  | Session Encryption
  |--------------------------------------------------------------------------
  */
  encrypt: false,

  /*
  |--------------------------------------------------------------------------
  | Session File Location (only for 'file' driver)
  |--------------------------------------------------------------------------
  */
  files: `${__dirname}/../storage/framework/sessions`,

  /*
  |--------------------------------------------------------------------------
  | Session Database Connection (for database/redis driver)
  |--------------------------------------------------------------------------
  */
  connection: process.env.SESSION_CONNECTION || null,

  /*
  |--------------------------------------------------------------------------
  | Session Database Table
  |--------------------------------------------------------------------------
  */
  table: 'sessions',

  /*
  |--------------------------------------------------------------------------
  | Session Cache Store
  |--------------------------------------------------------------------------
  */
  store: process.env.SESSION_STORE || null,

  /*
  |--------------------------------------------------------------------------
  | Session Sweeping Lottery
  |--------------------------------------------------------------------------
  */
  lottery: [2, 100],

  /*
  |--------------------------------------------------------------------------
  | Session Cookie Name
  |--------------------------------------------------------------------------
  */
  cookie:
    process.env.SESSION_COOKIE ||
    `${slugify(process.env.APP_NAME || 'node_app', { lower: true, strict: true })}_session`,

  /*
  |--------------------------------------------------------------------------
  | Session Cookie Path
  |--------------------------------------------------------------------------
  */
  path: '/',

  /*
  |--------------------------------------------------------------------------
  | Session Cookie Domain
  |--------------------------------------------------------------------------
  */
  domain: process.env.SESSION_DOMAIN || undefined,

  /*
  |--------------------------------------------------------------------------
  | HTTPS Only Cookies
  |--------------------------------------------------------------------------
  */
  secure: process.env.SESSION_SECURE_COOKIE === 'true',

  /*
  |--------------------------------------------------------------------------
  | HTTP Access Only
  |--------------------------------------------------------------------------
  */
  httpOnly: true,

  /*
  |--------------------------------------------------------------------------
  | Same-Site Cookies
  |--------------------------------------------------------------------------
  */
  sameSite: process.env.SESSION_SAME_SITE || 'lax', // lax, strict, none, null
};
